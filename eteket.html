<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <title>Клен етикетки</title>
    <style>
      @import url("https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css");
      * {
        -webkit-font-smoothing: antialiased;
        box-sizing: border-box;
      }
      html,
      body {
        margin: 0px;
        padding: 20px;
        font-family: "Inter", Helvetica, Arial, sans-serif;
      }
      
      button:focus-visible {
        outline: 2px solid #4a90e2 !important;
        outline: -webkit-focus-ring-color auto 5px !important;
      }
      a {
        text-decoration: none;
      }

      .search-container {
        max-width: 600px;
        margin: 0 auto 30px;
        padding: 20px;
        background: #f5f5f5;
        border-radius: 8px;
      }

      .search-container h2 {
        margin: 0 0 15px 0;
        font-size: 20px;
        font-weight: 600;
      }

      .input-group {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }

      #artikul-input {
        flex: 1;
        padding: 10px;
        font-size: 16px;
        border: 2px solid #ddd;
        border-radius: 4px;
      }

      #search-btn {
        padding: 10px 20px;
        font-size: 16px;
        background: #4a90e2;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: 600;
      }

      #search-btn:hover {
        background: #357abd;
      }

      #search-btn:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      .print-button {
        padding: 12px 24px;
        font-size: 16px;
        background: #2e7d32;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-weight: 600;
        margin-top: 20px;
        display: none;
      }

      .print-button:hover {
        background: #1b5e20;
      }

      .print-button.visible {
        display: inline-block;
      }

      .message {
        padding: 10px;
        border-radius: 4px;
        margin-top: 10px;
        display: none;
      }

      .message.error {
        background: #ffebee;
        color: #c62828;
        display: block;
      }

      .message.success {
        background: #e8f5e9;
        color: #2e7d32;
        display: block;
      }

      .message.loading {
        background: #e3f2fd;
        color: #1565c0;
        display: block;
      }

      .label-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
      }

      .box {
        position: relative;
        width: 586px;
        height: 189px;
        display: none;
      }

      .box.visible {
        display: block;
      }

      .box .group {
        position: absolute;
        top: 0;
        left: 0;
        width: 588px;
        height: 189px;
      }

      .box .rectangle {
        position: absolute;
        top: 0;
        left: 0;
        width: 586px;
        height: 189px;
        background-color: #ffffff;
        border: 1px solid;
        border-color: #000000;
      }

      .box .lizhko-karolina-eko {
        position: absolute;
        top: 1px;
        left: 426px;
        width: 159px;
        height: 119px;
        object-fit: cover;
      }

      .box .logo-neutral-d {
        position: absolute;
        top: 7px;
        left: 6px;
        width: 37px;
        height: 49px;
      }

      .box .frame {
        display: flex;
        flex-direction: column;
        width: 235px;
        align-items: center;
        gap: 5px;
        position: absolute;
        top: 7px;
        left: 120px;
      }

      .box .text-wrapper {
        position: relative;
        align-self: stretch;
        margin-top: -1.00px;
        font-family: "Inter", Helvetica;
        font-weight: 600;
        font-size: 24px;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
        text-align: center;
      }

      .box .div {
        align-self: stretch;
        font-size: 16px;
        text-align: center;
        position: relative;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .vlastuvosti {
        position: absolute;
        top: 120px;
        left: 408px;
        width: 170px;
        height: 63px;
      }

      .box .text-wrapper-2 {
        position: absolute;
        top: 0;
        left: 0;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .text-wrapper-3 {
        position: absolute;
        top: 0;
        left: 71px;
        font-family: "Inter", Helvetica;
        font-weight: 600;
        color: #000000;
        font-size: 10px;
        letter-spacing: 0;
        line-height: normal;
        white-space: nowrap;
      }

      .box .text-wrapper-4 {
        position: absolute;
        top: 16px;
        left: 0;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .text-wrapper-5 {
        position: absolute;
        top: 16px;
        left: 71px;
        font-family: "Inter", Helvetica;
        font-weight: 600;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .text-wrapper-6 {
        position: absolute;
        top: 32px;
        left: 0;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .text-wrapper-7 {
        position: absolute;
        top: 32px;
        left: 71px;
        font-family: "Inter", Helvetica;
        font-weight: 600;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .perelik {
        display: flex;
        flex-direction: column;
        width: 190px;
        height: 91px;
        align-items: flex-start;
        gap: 1px;
        position: absolute;
        top: 92px;
        left: 16px;
      }

      .box .frame-2 {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-template-rows: repeat(1, minmax(0, 1fr));
        height: 12px;
        gap: 1px;
        position: absolute;
        top: 0;
        left: 0;
        width: 190px;
      }

      .box .text-wrapper-8 {
        position: relative;
        grid-row: 1 / 2;
        grid-column: 1 / 2;
        width: 66px;
        height: 12px;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .text-wrapper-9 {
        grid-row: 1 / 2;
        grid-column: 2 / 3;
        justify-self: end;
        width: 22px;
        height: 12px;
        font-size: 10px;
        white-space: nowrap;
        position: relative;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .frame-3 {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-template-rows: repeat(1, minmax(0, 1fr));
        height: 13px;
        gap: 1px;
        position: absolute;
        top: 13px;
        left: 0;
        width: 190px;
      }

      .box .text-wrapper-10 {
        position: relative;
        grid-row: 1 / 2;
        grid-column: 1 / 2;
        width: 36px;
        height: 12px;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .frame-4 {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-template-rows: repeat(1, minmax(0, 1fr));
        height: 12px;
        gap: 1px;
        position: absolute;
        top: 27px;
        left: 0;
        width: 190px;
      }

      .box .text-wrapper-11 {
        position: relative;
        grid-row: 1 / 2;
        grid-column: 1 / 2;
        width: 133px;
        height: 12px;
        font-family: "Inter", Helvetica;
        font-weight: 400;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      .box .frame-5 {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        grid-template-rows: repeat(1, minmax(0, 1fr));
        height: 12px;
        gap: 1px;
        position: absolute;
        top: 40px;
        left: 0;
        width: 190px;
      }

      .box .text-wrapper-12 {
        position: absolute;
        top: 77px;
        left: 16px;
        font-family: "Inter", Helvetica;
        font-weight: 600;
        font-size: 10px;
        white-space: nowrap;
        color: #000000;
        letter-spacing: 0;
        line-height: normal;
      }

      @media print {
        body {
          padding: 0;
          margin: 0;
        }

        .search-container,
        .print-button {
          display: none !important;
        }

        .label-container {
          margin: 0;
          display: block;
        }

        .box {
          display: block !important;
          page-break-after: avoid;
        }
      }
    </style>
  </head>
  <body>
    <div class="search-container">
      <h2>Пошук етикетки за артикулом</h2>
      <div class="input-group">
        <input type="text" id="artikul-input" placeholder="Введіть артикул..." />
        <button id="search-btn">Знайти</button>
      </div>
      <div id="message" class="message"></div>
    </div>

    <div class="label-container">
      <div class="box" id="label-box">
        <div class="group">
          <div class="rectangle"></div>
          <img class="lizhko-karolina-eko" id="product-image" src="" alt="Фото товару" />
          <img class="logo-neutral-d" src="https://lh3.googleusercontent.com/d/1rLArp6Pr_eYM4d56r_wsxcY8Vf-haRBs" />
          <div class="frame">
            <div class="text-wrapper" id="product-name">Ліжко Кароліна Еко</div>
            <div class="div" id="product-size">120 х 200</div>
          </div>
          <div class="vlastuvosti">
            <div class="text-wrapper-2">Колір:</div>
            <div class="text-wrapper-3" id="product-color">Беж lw 06/1</div>
            <div class="text-wrapper-4">Деревина:</div>
            <div class="text-wrapper-5" id="product-wood">Бук</div>
            <div class="text-wrapper-6">Матеріал:</div>
            <div class="text-wrapper-7" id="product-material">Зрощений/Цільний</div>
          </div>
          <div class="perelik">
            <div class="frame-2">
              <div class="text-wrapper-8">Бокова царга</div>
              <div class="text-wrapper-9">2 шт</div>
            </div>
            <div class="frame-3">
              <div class="text-wrapper-10">Спинка</div>
              <div class="text-wrapper-9">2 шт</div>
            </div>
            <div class="frame-4">
              <div class="text-wrapper-11">Рейка для ламелей бокова</div>
              <div class="text-wrapper-9">2 шт</div>
            </div>
            <div class="frame-5">
              <div class="text-wrapper-10">Спинка</div>
              <div class="text-wrapper-9">2 шт</div>
            </div>
          </div>
          <div class="text-wrapper-12">Перелік деталей:</div>
        </div>
      </div>
      <button id="print-btn" class="print-button">🖨️ Друкувати етикетку</button>
    </div>

    <script>
      const SHEET_ID = '1ce3b7vIdVL0NSHDw2uIRXETbw5INoH5xXlHKAztnuPY';
      const SHEET_NAME = 'Baza';
      
      let sheetData = [];

      const messageEl = document.getElementById('message');
      const searchBtn = document.getElementById('search-btn');
      const artikulInput = document.getElementById('artikul-input');
      const labelBox = document.getElementById('label-box');
      const printBtn = document.getElementById('print-btn');

      function showMessage(text, type) {
        messageEl.textContent = text;
        messageEl.className = 'message ' + type;
      }

      function hideMessage() {
        messageEl.className = 'message';
      }

      async function loadSheetData() {
        showMessage('Завантаження даних з таблиці...', 'loading');
        searchBtn.disabled = true;

        try {
          const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;
          const response = await fetch(url);
          const text = await response.text();
          
          const jsonData = JSON.parse(text.substring(47).slice(0, -2));
          
          sheetData = jsonData.table.rows.map(row => {
            return row.c.map(cell => cell ? cell.v : '');
          });

          hideMessage();
          searchBtn.disabled = false;
          console.log('Дані завантажено:', sheetData.length, 'рядків');
        } catch (error) {
          showMessage('Помилка завантаження даних: ' + error.message, 'error');
          searchBtn.disabled = false;
          console.error('Помилка:', error);
        }
      }

      function searchArtikul(artikul) {
        if (!artikul.trim()) {
          showMessage('Будь ласка, введіть артикул', 'error');
          return;
        }

        const searchValue = artikul.trim().toLowerCase();
        
        const foundRow = sheetData.find(row => {
          const cellValue = String(row[0] || '').toLowerCase().trim();
          return cellValue === searchValue;
        });

        if (foundRow) {
          updateLabel(foundRow);
          showMessage('Артикул знайдено!', 'success');
          labelBox.classList.add('visible');
          printBtn.classList.add('visible');
        } else {
          showMessage('Артикул не знайдено в базі даних', 'error');
          labelBox.classList.remove('visible');
          printBtn.classList.remove('visible');
        }
      }

      function updateLabel(rowData) {
        document.getElementById('product-name').textContent = rowData[1] || 'Назва не вказана';
        document.getElementById('product-size').textContent = rowData[2] || '';
        document.getElementById('product-color').textContent = rowData[3] || '';
        document.getElementById('product-wood').textContent = rowData[4] || '';
        document.getElementById('product-material').textContent = rowData[5] || '';
        
        const imageUrl = rowData[6] || '';
        const imageEl = document.getElementById('product-image');
        if (imageUrl) {
          imageEl.src = imageUrl;
          imageEl.style.display = 'block';
        } else {
          imageEl.style.display = 'none';
        }
      }

      function printLabel() {
        window.print();
      }

      searchBtn.addEventListener('click', () => {
        searchArtikul(artikulInput.value);
      });

      artikulInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          searchArtikul(artikulInput.value);
        }
      });

      printBtn.addEventListener('click', printLabel);

      loadSheetData();
    </script>
  </body>
</html>
